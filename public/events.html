<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Events Showcase</title>
    <link rel="icon" href="logo.png" type="image/x-icon">
    <link rel="stylesheet" href="header-footer.css">
    <link rel="stylesheet" href="main.css" />
    <style>
        /* -------------------- Main Event Slider -------------------- */
        .main-event-slider {
            width: 100vw;
            margin: 1px 0;
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            background-color: rgba(0, 0, 0, 0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 0 10px;
            box-sizing: border-box;
            padding-top: 70px;
        }

        .slide-main {
            display: none;
            grid-template-columns: 1fr 1.2fr;
            gap: 20px;
            align-items: center;
            width: 100%;
            
        }

        .slide-main.active-slide {
            display: grid;
        }

        .event-info-box {
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.95);
            border-radius: 8px;
        }

        .event-name-main {
            color: #ffb300;
            margin-left: 70px;
            font-size: 4em;
            align-items:center;
            margin-bottom: 15px 15px;
        }

        .event-image-box img {
            width: 800px;
            height: 500px;
            object-fit: cover;
            border-radius: 8px;
        }

        .arrow-main {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: #ffb300;
            color: #000;
            border: none;
            font-size: 2em;
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 50%;
            z-index: 50;
        }

        .left-arrow-main {
            left: 25px;
        }

        .right-arrow-main {
            right: 30px;
        }

        .slider-dots-main {
            text-align: absolute;
            margin-top: 15px;
        }

        .dot-main {
            height: 12px;
            width: 12px;
            background-color: #aaa;
            border-radius: 50%;
            display: inline-block;
            margin: 0 6px;
            cursor: pointer;
        }

        .dot-main.active-dot {
            background-color: #00a8e1;
        }

        @media (max-width: 1024px) {
            .slide-main {
                grid-template-columns: 1fr;
                aspect-ratio: 4/3;
                
            }

            .left-arrow-main {
                left: 5px;
            }

            .right-arrow-main {
                right: 5px;
            }
        }

        @media (max-width: 768px) {
            
            .slide-main {
                aspect-ratio: 16/15;
                
            }

            .event-info-box {
                padding: 10px;
            }

            .event-name-main {
                font-size: 1.4em;
            }

            .event-info-box p {
                font-size: 0.9em;
            }
        }
    </style>
</head>

<body>
    <div class="wrapper">

        <!-- Header -->
        <header>
        <div class="logo">Phantasm Blaze</div>
        <div class="hamburger" id="hamburger" onclick="toggleMenu()">
            <div></div>
            <div></div>
            <div></div>
        </div>
        <div class="close-icon" id="closeIcon" onclick="toggleMenu()">&#x2715;</div>
        <nav>
            <a href="index.html">Home</a>
            <a href="events.html">Events</a>
            <a href="schedule.html">Schedule</a>
            <a href="contact-us.html">Contact</a>
            <a href="profile.html" id="profileLinkDesktop">Profile</a>
            <a href="login.html">Login</a>
        </nav>
        <div class="side-menu" id="sideMenu">
            <!-- Example folder-based links -->
            <a href="index.html">Home</a>
            <a href="events.html">Events</a>
            <a href="schedule.html">Schedule</a>
            <a href="contact-us.html">Contact</a>
<a href="#" id="profileLinkMobile">Profile</a>
            <a href="login.html">Login</a>
        </div>
    </header>

        <!-- Main Event Slider -->
        <section class="main-event-slider">
            <div class="slide-main active-slide">
                <div class="event-info-box">
                    <h1 class="event-name-main">CodeCipher</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/codecipher.jpg" alt="CodeCipher Event">
                </div>
            </div>
            <div class="slide-main">
                <div class="event-info-box">
                    <h1 class="event-name-main">QueryQuest</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/queryquest.jpg" alt="QueryQuest Event">
                </div>
            </div>
            <div class="slide-main">
                <div class="event-info-box">
                    <h1 class="event-name-main">Paper Presentation</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/paperpresentation.jpg" alt="Tech Talk Event">
                </div>
            </div>
            <div class="slide-main">
                <div class="event-info-box">
                    <h1 class="event-name-main">GenSight</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/gensight.jpg" alt="GenSight Event">
                </div>
            </div>
            <div class="slide-main">
                <div class="event-info-box">
                    <h1 class="event-name-main">CodeVertex</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/codevertex.jpg" alt="CodeVertex Event">
                </div>
            </div>
            <div class="slide-main">
                <div class="event-info-box">
                    <h1 class="event-name-main">FreeFire</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/pubg.jpg" alt="Pubg or FreeFire">
                </div>
            </div>
            <div class="slide-main">
                <div class="event-info-box">
                    <h1 class="event-name-main">Power Picks</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/powerpicks.jpg" alt="Power Picks">
                </div>
            </div>
            <div class="slide-main">
                <div class="event-info-box">
                    <h1 class="event-name-main">Twist and Trek</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/twistandtrek.jpg" alt="Twist and Trek">
                </div>
            </div>
            <div class="slide-main">
                <div class="event-info-box">
                    <h1 class="event-name-main">ClueCraze</h1>
                </div>
                <div class="event-image-box">
                    <img src="images/cluecraze.jpg" alt="ClueCraze">
                </div>
            </div>

            <button class="arrow-main left-arrow-main">&#10094;</button>
            <button class="arrow-main right-arrow-main">&#10095;</button>

        
        </section>

        <!-- Technical Events -->
        <div class="container">
            <h2>Technical Events</h2>
            <div class="slider-section">
                <button class="nav-btn left" onclick="slide('tech', -1)">‹</button>
                
                <div class="events-slider" id="tech">
                    <div class="event-card" onclick="redirectTo('tech_talk.html')">
                        <img src="images/paperpresentation.jpg" alt="Paper Presentation">
                        <div class="overlay">
                            <h3>Paper Presentation</h3>
                            <p>Showcase Innovative Ideas</p>
                        </div>
                    </div>
                    <div class="event-card" onclick="redirectTo('CodeCipher.html')">
                        <img src="images/codecipher.jpg" alt="CodeCipher">
                        <div class="overlay">
                            <h3>CodeCipher</h3>
                            <p>Competitive Coding Event</p>
                        </div>
                    </div>
                    <div class="event-card" onclick="redirectTo('QueryQuest.html')">
                        <img src="images/queryquest.jpg" alt="QueryQuest">
                        <div class="overlay">
                            <h3>QueryQuest</h3>
                            <p>Database Debugging Challenge</p>
                        </div>
                    </div>
                    
                    <div class="event-card" onclick="redirectTo('GenSight.html')">
                        <img src="images/gensight.jpg" alt="GenSight">
                        <div class="overlay">
                            <h3>GenSight</h3>
                            <p>Innovative Generation</p>
                        </div>
                    </div>
                    <div class="event-card" onclick="redirectTo('CodeVortex.html')">
                        <img src="images/codevertex.jpg" alt="CodeVertex">
                        <div class="overlay">
                            <h3>CodeVertex</h3>
                            <p>Software Design Contest</p>
                        </div>
                    </div>
                </div>
                <button class="nav-btn right" onclick="slide('tech', 1)">›</button>
            </div>

            <!-- Non Technical Events -->
            <h2>Non Technical Events</h2>
            <div class="slider-section">
                <button class="nav-btn left" onclick="slide('nontech', -1)">‹</button>
                <div class="events-slider" id="nontech">
                    <div class="event-card" onclick="redirectTo('Pubg or FreeFire.html')">
                        <img src="images/pubg.jpg" alt="Pubg or FreeFire">
                        <div class="overlay">
                            <h3>FreeFire</h3>
                            <p>Gaming Tournament</p>
                        </div>
                    </div>
                    <div class="event-card" onclick="redirectTo('Power Picks.html')">
                        <img src="images/powerpicks.jpg" alt="Power Picks">
                        <div class="overlay">
                            <h3>Power Picks</h3>
                            <p>Cricket Auction Challenge</p>
                        </div>
                    </div>
                    <div class="event-card" onclick="redirectTo('Twist and Trek.html')">
                        <img src="images/twistandtrek.jpg" alt="Twist and Trek">
                        <div class="overlay">
                            <h3>Twist and Trek</h3>
                            <p>Fun Logical Games</p>
                        </div>
                    </div>
                    <div class="event-card" onclick="redirectTo('ClueCraze.html')">
                        <img src="images/cluecraze.jpg" alt="ClueCraze">
                        <div class="overlay">
                            <h3>ClueCraze</h3>
                            <p>Outdoor Puzzle Adventure</p>
                        </div>
                    </div>
                </div>
                <button class="nav-btn right" onclick="slide('nontech', 1)">›</button>
            </div>
        </div>

        <!-- Footer -->
        <footer>
        <p>&copy; 2025 CSEA. All rights reserved.</p>
    </footer>
    </div>

    <!-- JavaScript -->
     <script>
    // Function to toggle the side menu
function toggleMenu() {
    const sideMenu = document.getElementById('sideMenu');
    const hamburger = document.getElementById('hamburger');
    const closeIcon = document.getElementById('closeIcon');

    // Toggle side menu visibility
    sideMenu.classList.toggle('open');

    // Toggle visibility of hamburger and close icon
    if (sideMenu.classList.contains('open')) {
        hamburger.style.display = 'none';
        closeIcon.style.display = 'block';
    } else {
        hamburger.style.display = 'flex';
        closeIcon.style.display = 'none';
    }
}

// Function to handle redirects - moved to global scope
function redirectTo(page) {
    window.location.href = page;
}

document.addEventListener("DOMContentLoaded", function () {

    // -------------------- MAIN EVENT SLIDER --------------------
    let slideIndexMain = 0;
    const slidesMain = document.querySelectorAll(".slide-main");
    const dotsMain = document.querySelectorAll(".dot-main");

    // Prevent running if no slides found
    if (slidesMain.length === 0) return;

    function showMainSlide(index) {
        if (index >= slidesMain.length) index = 0;
        if (index < 0) index = slidesMain.length - 1;

        slidesMain.forEach(slide => slide.classList.remove("active-slide"));
        dotsMain.forEach(dot => dot.classList.remove("active-dot"));

        slidesMain[index].classList.add("active-slide");

        // Only add dot class if it exists
        if (dotsMain[index]) dotsMain[index].classList.add("active-dot");

        slideIndexMain = index;
    }

    function nextMainSlide() {
        showMainSlide(slideIndexMain + 1);
    }

    function prevMainSlide() {
        showMainSlide(slideIndexMain - 1);
    }

    // Arrow buttons
    const leftArrow = document.querySelector(".left-arrow-main");
    const rightArrow = document.querySelector(".right-arrow-main");

    if (leftArrow) leftArrow.addEventListener("click", prevMainSlide);
    if (rightArrow) rightArrow.addEventListener("click", nextMainSlide);

    // Dots navigation
    dotsMain.forEach((dot, i) => dot.addEventListener("click", () => showMainSlide(i)));

    // Auto-slide every 5 seconds
    let autoSlideMain = setInterval(nextMainSlide, 3000);

    // Pause on hover
    const mainSlider = document.querySelector(".main-event-slider");
    if (mainSlider) {
        mainSlider.addEventListener("mouseover", () => clearInterval(autoSlideMain));
        mainSlider.addEventListener("mouseout", () => autoSlideMain = setInterval(nextMainSlide, 3000));
    }

    // Initialize first slide
    showMainSlide(slideIndexMain);

    // -------------------- TECHNICAL / NON-TECHNICAL SLIDERS --------------------
    function slide(id, direction) {
        const slider = document.getElementById(id);
        if (!slider) return;
        const scrollAmount = slider.clientWidth * 0.8;
        slider.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
    }
});


        // Function to toggle the side menu
        function toggleMenu() {
            const sideMenu = document.getElementById('sideMenu');
            const hamburger = document.getElementById('hamburger');
            const closeIcon = document.getElementById('closeIcon');
    
            // Toggle side menu visibility
            sideMenu.classList.toggle('open');
    
            // Toggle visibility of hamburger and close icon
            if (sideMenu.classList.contains('open')) {
                hamburger.style.display = 'none';
                closeIcon.style.display = 'block';
            } else {
                hamburger.style.display = 'flex';
                closeIcon.style.display = 'none';
            }
        }
    

    
        // Add ripple effect to header, footer, and side menu

        
function registerForEvent(eventId) {
    console.log("Starting event registration...");

    fetch('/api/events/register', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        credentials: 'include',
        body: JSON.stringify({ eventId })
    })
    .then(async response => {
        console.log("Response received:", response.status);
        
        if (response.status === 401) {
            window.location.href = '/login.html';
        }

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(errorData.error || "Unknown error");
        }

        return response.json();
    })
    .then(result => {
        console.log("Registration successful:", result);
        alert('Event registered successfully!');

        // ✅ Set a flag in localStorage so profile.html can detect and update events
        localStorage.setItem("updateEvents", "true");

        // Redirect user to profile page where updateRegisteredEvents() is defined
        window.location.href = "/profile.html";
    })
    .catch(error => {
        console.error("Error occurred:", error);
        alert(error.message || "An error occurred. Please try again.");
    });
}

document.getElementById("profileLinkDesktop").addEventListener("click", checkAuth);
document.getElementById("profileLinkMobile").addEventListener("click", checkAuth);

async function checkAuth(event) {
    event.preventDefault();
    
    try {
        const response = await fetch("/api/user/check-auth", {
            method: "GET",
            credentials: "include"
        });

        if (response.ok) {
            window.location.href = "/profile.html";
        } else {
            alert("Login first!");
            window.location.href = "/login.html";
        }
    } catch (error) {
        console.error("Error checking authentication:", error);
        alert("Login first!");
        window.location.href = "/login.html";
    }
}



document.querySelector('.logo').addEventListener('click', function() {
    window.location.href = 'index.html';
  });

    
</script>
</body>

</html>